import Qupla

// convert input value from 'binary' trit value to trinary value
// 'binary' input trits can only be 0 or 1

template bin2trin<T>
{
  func T bin2trin<T>(T val)
  {
    return bin2trin2<T>(val, 0, 1)
  }

  func T bin2trin2<T>(T remain , T sum, T power)
  {
    newSum = isOne[remain[0]] ? add<T>(sum, power) : sum
    done = isZero[sign<T>(remain)]
    return done ? sum : bin2trin2<T>(lshift<T>(remain), newSum, add<T>(power, power))
  }
}


test 0 = bin2trin<Int>(0)
test 1 = bin2trin<Int>(1)
test 2 = bin2trin<Int>(3)
test 3 = bin2trin<Int>(4)
test 15 = bin2trin<Int>(40)
test 255 = bin2trin<Int>(3280)
test 65535 = bin2trin<Int>(21523360)
test 4294967295 = bin2trin<Huge>(926510094425920)
// some of the tests may be grained with zeroes inbetween the 111...111 sequence, don't worry when calculating 2^n-1 and (3^n-1)/2 yourown
test 340282366920938463463374607431768211455 = bin2trin<Hash>(5895092288869291585760436430706259332839105796137920554548480)
test 115792089237316195423570985008687907853269984665640564039457584007913129639935
  = bin2trin<Hash3>(69504226188572366382469893394830651557109425404264568995802412215018036314883217970500884577054804760905832770274449717760)
test 13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084095
  = bin2trin<Hash3>(9661674916144457552727034361009790527700732880801664275092268814451233373207768500008969714893014677195041164647293059752576754550666470442049020239364319771280275066863699741389031161203686169060521699834121138295895752329492941497636218270720)
test 179769308128688554841593914336777228061788645087206598745762043938980733953745707508027864856415641942640823241898028769893055642878690194031277212647185337028480491457581597864186726890708791588267512013107914692314913190551492247774529330958055264124819053398988059396676162108264800478523162911021390102523
  = bin2trin<Hash9>(186695924370069331493319608213469809026120840269878529864401083138484546852557016082547942836221729172284179845394434319822072666510763444429975462187449479415343223072455417061004069708018863884709587406765210511026171923411791023565100951052266843751891497803359615503592287914493445124195050471647146311769968524981088534884337335397635320260306267407703218825677345201222906845325815734555633487154320091345760111767956553023832139344844800265683541905371098976094347829428199236771564)
